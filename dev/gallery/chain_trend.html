


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
        <title>Chaining operations &mdash; Verde</title>
    


  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Gridding with Scipy" href="scipygridder.html" />
    <link rel="prev" title="Different weights in block mean" href="blockmean_weights.html" />
    
    <script src="../_static/require.js"></script>


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/verde-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="block_reduce.html">Data decimation in blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="distance_mask.html">Mask grid points by distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="block_reduce_weights.html">Data decimation with weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="trend.html">Polynomial trend</a></li>
<li class="toctree-l2"><a class="reference internal" href="blockmean_weights.html">Different weights in block mean</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Chaining operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="scipygridder.html">Gridding with Scipy</a></li>
<li class="toctree-l2"><a class="reference internal" href="vector_trend.html">Trends in vector data</a></li>
<li class="toctree-l2"><a class="reference internal" href="spline.html">Gridding with splines and weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="vector2d.html">Gridding 2-component vector data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sample_data/index.html">Sample Data</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/decimation.html">Data decimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/weights.html">Using weights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Getting help and contributing
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://www.fatiando.org"><i class="fa fa-external-link-square fa-fw"></i> Fatiando a Terra</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/verde/blob/master/CONTRIBUTING.md"><i class="fa fa-users fa-fw"></i> Contributing</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/verde/blob/master/CODE_OF_CONDUCT.md"><i class="fa fa-gavel fa-fw"></i> Code of Conduct</a></li>
            
                <li class="toctree-l1"><a href="https://gitter.im/fatiando/fatiando"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/verde"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Verde</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Gallery</a> &raquo;</li>
        
      <li>Chaining operations</li>
    
    
    <li class="source-link">
        
            
                
                
                
                    
                
                <a href="https://github.com/fatiando/verde/edit/master/doc/../examples/chain_trend.py"
                   class="fa fa-github"> Improve this page</a>
            
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="chaining-operations">
<span id="sphx-glr-gallery-chain-trend-py"></span><h1>Chaining operations<a class="headerlink" href="#chaining-operations" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="../api/generated/verde.Chain.html#verde.Chain" title="verde.Chain"><code class="xref py py-class docutils literal notranslate"><span class="pre">verde.Chain</span></code></a> class allows us to created gridders that perform multiple
operations on data. Each step in the chain filters the input and passes the result along
to the next step. For gridders and trend estimators, filtering means fitting the model
and passing along the residuals (input data minus predicted data). When predicting data,
the predictions of each step are added together. Other operations, like
<a class="reference internal" href="../api/generated/verde.BlockReduce.html#verde.BlockReduce" title="verde.BlockReduce"><code class="xref py py-class docutils literal notranslate"><span class="pre">verde.BlockReduce</span></code></a> and <a class="reference internal" href="../api/generated/verde.BlockMean.html#verde.BlockMean" title="verde.BlockMean"><code class="xref py py-class docutils literal notranslate"><span class="pre">verde.BlockMean</span></code></a> change the input data values and
the coordinates as well but don’t impact the predictions.</p>
<p>For example, say we want to decimate some data, calculate a polynomial trend, and fit a
gridder on the residual values (not the trend), but then make a grid of the full data
values (trend included). This is useful because decimation is common and many gridders
can’t handle trends in data.</p>
<img alt="../_images/sphx_glr_chain_trend_001.png" class="align-center" src="../_images/sphx_glr_chain_trend_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Chained</span> <span class="n">estimator</span><span class="p">:</span> <span class="n">Chain</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;trend&#39;</span><span class="p">,</span> <span class="n">Trend</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;reduce&#39;</span><span class="p">,</span> <span class="n">BlockReduce</span><span class="p">(</span><span class="n">adjust</span><span class="o">=</span><span class="s1">&#39;spacing&#39;</span><span class="p">,</span> <span class="n">center_coordinates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
      <span class="n">reduction</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">mean</span> <span class="n">at</span> <span class="mh">0x14df14d33a60</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
      <span class="n">spacing</span><span class="o">=</span><span class="mf">925.0</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;spline&#39;</span><span class="p">,</span> <span class="n">Spline</span><span class="p">(</span><span class="n">damping</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span> <span class="n">fudge</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="kc">None</span><span class="p">))])</span>

<span class="n">Trend</span> <span class="n">grid</span><span class="p">:</span>
<span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>   <span class="p">(</span><span class="n">easting</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span> <span class="n">northing</span><span class="p">:</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">easting</span>   <span class="p">(</span><span class="n">easting</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">4.391e+06</span> <span class="o">-</span><span class="mf">4.391e+06</span> <span class="o">-</span><span class="mf">4.39e+06</span> <span class="o">-</span><span class="mf">4.389e+06</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">northing</span>  <span class="p">(</span><span class="n">northing</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">2.366e+06</span> <span class="o">-</span><span class="mf">2.366e+06</span> <span class="o">-</span><span class="mf">2.365e+06</span> <span class="o">-</span><span class="mf">2.365e+06</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">scalars</span>   <span class="p">(</span><span class="n">northing</span><span class="p">,</span> <span class="n">easting</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">91.02</span> <span class="mf">92.92</span> <span class="mf">94.83</span> <span class="mf">96.74</span> <span class="mf">98.65</span> <span class="o">...</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">metadata</span><span class="p">:</span>  <span class="n">Generated</span> <span class="n">by</span> <span class="n">Trend</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">Residual</span> <span class="n">grid</span><span class="p">:</span>
<span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>   <span class="p">(</span><span class="n">easting</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span> <span class="n">northing</span><span class="p">:</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">easting</span>   <span class="p">(</span><span class="n">easting</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">4.391e+06</span> <span class="o">-</span><span class="mf">4.391e+06</span> <span class="o">-</span><span class="mf">4.39e+06</span> <span class="o">-</span><span class="mf">4.389e+06</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">northing</span>  <span class="p">(</span><span class="n">northing</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">2.366e+06</span> <span class="o">-</span><span class="mf">2.365e+06</span> <span class="o">-</span><span class="mf">2.365e+06</span> <span class="o">-</span><span class="mf">2.364e+06</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">scalars</span>   <span class="p">(</span><span class="n">northing</span><span class="p">,</span> <span class="n">easting</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">25.57</span> <span class="mf">28.48</span> <span class="mf">29.73</span> <span class="mf">28.98</span> <span class="mf">27.76</span> <span class="o">...</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">metadata</span><span class="p">:</span>  <span class="n">Generated</span> <span class="n">by</span> <span class="n">Spline</span><span class="p">(</span><span class="n">damping</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span> <span class="n">fudge</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s</span><span class="o">...</span>

<span class="n">Chained</span> <span class="n">geographic</span> <span class="n">grid</span><span class="p">:</span>
<span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>              <span class="p">(</span><span class="n">latitude</span><span class="p">:</span> <span class="mi">61</span><span class="p">,</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">73</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">longitude</span>            <span class="p">(</span><span class="n">longitude</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">42.6</span> <span class="o">-</span><span class="mf">42.59</span> <span class="o">-</span><span class="mf">42.58</span> <span class="o">-</span><span class="mf">42.57</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">latitude</span>             <span class="p">(</span><span class="n">latitude</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">22.5</span> <span class="o">-</span><span class="mf">22.49</span> <span class="o">-</span><span class="mf">22.48</span> <span class="o">-</span><span class="mf">22.48</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">total_field_anomaly</span>  <span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">115.0</span> <span class="mf">120.8</span> <span class="mf">123.0</span> <span class="o">...</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">metadata</span><span class="p">:</span>  <span class="n">Generated</span> <span class="n">by</span> <span class="n">Chain</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;trend&#39;</span><span class="p">,</span> <span class="n">Trend</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;reduce...</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="kn">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">pyproj</span>
<span class="kn">import</span> <span class="nn">verde</span> <span class="kn">as</span> <span class="nn">vd</span>

<span class="c1"># Load the Rio de Janeiro total field magnetic anomaly data</span>
<span class="n">data</span> <span class="o">=</span> <a href="../api/generated/verde.datasets.fetch_rio_magnetic.html#verde.datasets.fetch_rio_magnetic" title="View documentation for verde.datasets.fetch_rio_magnetic"><span class="n">vd</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fetch_rio_magnetic</span></a><span class="p">()</span>
<span class="n">region</span> <span class="o">=</span> <a href="../api/generated/verde.get_region.html#verde.get_region" title="View documentation for verde.get_region"><span class="n">vd</span><span class="o">.</span><span class="n">get_region</span></a><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>

<span class="c1"># Create a projection for the data using pyproj so that we can use it as input for the</span>
<span class="c1"># gridder. We&#39;ll set the latitude of true scale to the mean latitude of the data.</span>
<span class="n">projection</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s2">&quot;merc&quot;</span><span class="p">,</span> <span class="n">lat_ts</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># Create a chain that fits a 2nd degree trend, decimates the residuals using a blocked</span>
<span class="c1"># mean to avoid aliasing, and then fits a standard gridder to the residuals. The spacing</span>
<span class="c1"># for the blocked mean will be 0.5 arc-minutes (approximately converted to meters).</span>
<span class="n">spacing</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="mi">60</span>
<span class="n">chain</span> <span class="o">=</span> <a href="../api/generated/verde.Chain.html#verde.Chain" title="View documentation for verde.Chain"><span class="n">vd</span><span class="o">.</span><span class="n">Chain</span></a><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;trend&quot;</span><span class="p">,</span> <a href="../api/generated/verde.Trend.html#verde.Trend" title="View documentation for verde.Trend"><span class="n">vd</span><span class="o">.</span><span class="n">Trend</span></a><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;reduce&quot;</span><span class="p">,</span> <a href="../api/generated/verde.BlockReduce.html#verde.BlockReduce" title="View documentation for verde.BlockReduce"><span class="n">vd</span><span class="o">.</span><span class="n">BlockReduce</span></a><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">spacing</span> <span class="o">*</span> <span class="mf">111e3</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;spline&quot;</span><span class="p">,</span> <a href="../api/generated/verde.Spline.html#verde.Spline" title="View documentation for verde.Spline"><span class="n">vd</span><span class="o">.</span><span class="n">Spline</span></a><span class="p">(</span><span class="n">damping</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Chained estimator:&quot;</span><span class="p">,</span> <span class="n">chain</span><span class="p">)</span>
<span class="c1"># Calling &#39;fit&#39; will automatically run the data through the chain</span>
<span class="n">chain</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">projection</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">total_field_anomaly_nt</span>
<span class="p">)</span>

<span class="c1"># Each component of the chain can be accessed separately using the &#39;named_steps&#39;</span>
<span class="c1"># attribute</span>
<span class="n">grid_trend</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s2">&quot;trend&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Trend grid:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">grid_trend</span><span class="p">)</span>

<span class="n">grid_residual</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s2">&quot;spline&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Residual grid:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">grid_residual</span><span class="p">)</span>

<span class="c1"># Chain.grid will use both the trend and the gridder to predict values. We&#39;ll use the</span>
<span class="c1"># &#39;projection&#39; keyword to generate a geographic grid instead of Cartesian</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
    <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
    <span class="n">spacing</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
    <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">],</span>
    <span class="n">data_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;total_field_anomaly&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Chained geographic grid:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

<span class="c1"># We&#39;ll plot only the chained grid on a Mercator map</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">crs</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;De-trend, decimate, and spline&quot;</span><span class="p">)</span>
<span class="n">maxabs</span> <span class="o">=</span> <a href="../api/generated/verde.maxabs.html#verde.maxabs" title="View documentation for verde.maxabs"><span class="n">vd</span><span class="o">.</span><span class="n">maxabs</span></a><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">total_field_anomaly</span><span class="p">)</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">total_field_anomaly</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;seismic&quot;</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=-</span><span class="n">maxabs</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="n">maxabs</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;total field anomaly [nT]&quot;</span><span class="p">)</span>
<span class="c1"># Set the proper ticks for a Cartopy map</span>
<a href="../api/generated/verde.datasets.setup_rio_magnetic_map.html#verde.datasets.setup_rio_magnetic_map" title="View documentation for verde.datasets.setup_rio_magnetic_map"><span class="n">vd</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">setup_rio_magnetic_map</span></a><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  12.982 seconds)</p>
<div class="sphx-glr-footer docutils container">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/chain_trend.py" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">chain_trend.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/chain_trend.ipynb" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">chain_trend.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="scipygridder.html" class="btn btn-neutral float-right" title="Gridding with Scipy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="blockmean_weights.html" class="btn btn-neutral" title="Different weights in block mean" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2018, Leonardo Uieda.
      Last updated on Jul 04, 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>